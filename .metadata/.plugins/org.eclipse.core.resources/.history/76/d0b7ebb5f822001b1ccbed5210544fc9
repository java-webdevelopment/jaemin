package com.nucpoop.banking.manager;

import java.util.Scanner;

import com.nucpoop.banking.dto.UserDto;

public class LoginManager {

	private static LoginManager instance = new LoginManager();
	private Scanner scanner = new Scanner(System.in);
	private String input;
	private boolean isLogin;

	private LoginManager() {
		input = "";
		isLogin = false;
	}

	public static LoginManager getInstance() {
		return instance;
	}

	public static void clearScreen() {
		System.out.print("\033[H\033[2J");
		System.out.flush();
	}

	public void process() {
		while (!isLogin) {
			clearScreen();
			System.out.println("Login");
			System.out.println("======================");
			System.out.println("a. Create account");
			System.out.println("b. Sign in");
			System.out.print("Select menu >>");
			input = scanner.nextLine();
			char select = input.charAt(0);

			switch (select) {
			case 'A':
			case 'a':
				signUp();
				break;
			case 'B':
			case 'b':
				signIn();
				break;
			default:
				break;
			}
		}
	}

	private void signUp() {
		String id = "";
		String pswd = "";

		System.out.print("Input NEW id : ");
		id = scanner.nextLine();
		System.out.print("Input NEW password : ");
		pswd = scanner.nextLine();
		System.out.print("Input CONFIRM password : ");
		input = scanner.nextLine();

		if (pswd.equals(input)) {
			UserDto userDto = new UserDto(id, pswd);
			DBManager.getInstance().insertAccount(userDto);
		} else {
			return;
		}
	}

	private void signIn() {
		String id = "";
		String pswd = "";

		System.out.print("Input id : ");
		id = scanner.nextLine();
		System.out.print("Input password : ");
		pswd = scanner.nextLine();
		
		UserDto userDto = new UserDto(id, pswd);
		DBManager.getInstance().insertAccount(userDto);
	}

}
